TorchLogger created at 21/03/18 15:30:54
15:30:54 ===== CONFIG =====
15:30:54 name: segmentation_13
15:30:54 pretrain_name: None
15:30:54 cv: 5
15:30:54 num_epochs: 15
15:30:54 batch_size: 48
15:30:54 seed: 2021
15:30:54 dataset: CLiPDatasetSegmentation(*)
15:30:54 dataset_params: 
{ 'annotation_size': 60,
  'annotation_style': 'line',
  'cmap': { 'CVC - Abnormal': 2,
            'CVC - Borderline': 2,
            'CVC - Normal': 2,
            'ETT - Abnormal': 0,
            'ETT - Borderline': 0,
            'ETT - Normal': 0,
            'NGT - Abnormal': 1,
            'NGT - Borderline': 1,
            'NGT - Incompletely Imaged': 1,
            'NGT - Normal': 1,
            'Swan Ganz Catheter Present': 2},
  'df_annotations': PosixPath('../data/ranzcr-clip/train_annotations.csv'),
  'grayscale': False,
  'use_annotations': True,
  'use_lungcontour': False}
15:30:54 img_size: 768
15:30:54 num_classes: 11
15:30:54 transforms: 
{ 'test': Compose([
  Resize(always_apply=False, p=1, height=768, width=768, interpolation=1),
  Normalize(always_apply=False, p=1.0, mean=0.4824, std=0.225, max_pixel_value=255.0),
  ToTensorV2(always_apply=True, p=1.0),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={}),
  'train': Compose([
  RandomResizedCrop(always_apply=False, p=1, height=768, width=768, scale=(0.9, 1), ratio=(0.75, 1.3333333333333333), interpolation=1),
  HorizontalFlip(always_apply=False, p=0.5),
  ShiftScaleRotate(always_apply=False, p=0.5, shift_limit=(-0.0625, 0.0625), scale_limit=(-0.09999999999999998, 0.10000000000000009), rotate_limit=(-45, 45), interpolation=1, border_mode=4, value=None, mask_value=None),
  HueSaturationValue(always_apply=False, p=0.5, hue_shift_limit=(-10, 10), sat_shift_limit=(-10, 10), val_shift_limit=(-10, 10)),
  RandomBrightnessContrast(always_apply=False, p=0.5, brightness_limit=(-0.2, 0.2), contrast_limit=(-0.2, 0.2), brightness_by_max=True),
  OneOf([
    OpticalDistortion(always_apply=False, p=0.5, distort_limit=(-0.05, 0.05), shift_limit=(-0.05, 0.05), interpolation=1, border_mode=4, value=None, mask_value=None),
    IAAPiecewiseAffine(always_apply=False, p=0.5, scale=(0.03, 0.05), nb_rows=4, nb_cols=4, order=1, cval=0, mode='constant'),
  ], p=0.1),
  OneOf([
    GaussNoise(always_apply=False, p=0.5, var_limit=(10.0, 50.0)),
    MotionBlur(always_apply=False, p=0.5, blur_limit=(3, 5)),
  ], p=0.1),
  Cutout(always_apply=False, p=0.5, num_holes=5, max_h_size=76, max_w_size=76),
  Normalize(always_apply=False, p=1.0, mean=0.4824, std=0.225, max_pixel_value=255.0),
  ToTensorV2(always_apply=True, p=1.0),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={}),
  'tta': Compose([
  Resize(always_apply=False, p=1, height=768, width=768, interpolation=1),
  Normalize(always_apply=False, p=1.0, mean=0.4824, std=0.225, max_pixel_value=255.0),
  ToTensorV2(always_apply=True, p=1.0),
], p=1.0, bbox_params=None, keypoint_params=None, additional_targets={})}
15:30:54 splitter: <utils.MultiStratifiedGroupKFold object at 0x7fcd8b9811d0>
15:30:54 model: Unet(*)
15:30:54 model_params: 
{ 'activation': 'sigmoid',
  'classes': 3,
  'encoder_name': 'resnet200d',
  'encoder_weights': 'imagenet',
  'in_channels': 3}
15:30:54 optimizer: Adam(*)
15:30:54 optimizer_params: 
{'lr': 0.0005}
15:30:54 scheduler: CosineAnnealingWarmRestarts(*)
15:30:54 scheduler_params: 
{'T_0': 5, 'T_mult': 1, 'eta_min': 1e-06}
15:30:54 batch_scheduler: False
15:30:54 scheduler_target: None
15:30:54 criterion: DiceLoss(
  (activation): Activation(
    (activation): Identity()
  )
)
15:30:54 eval_metric: IoU(
  (loss): IoU(
    (activation): Activation(
      (activation): Identity()
    )
  )
)
15:30:54 monitor_metrics: 
[]
15:30:54 amp: True
15:30:54 parallel: ddp
15:30:54 hook: <kuma_utils.torch.hooks.simple_hook.TrainHook object at 0x7fcd8b92ae90>
15:30:54 callbacks: 
[ EarlyStopping(
{ 'best_epoch': None,
  'best_score': None,
  'counter': 0,
  'maximize': True,
  'patience': 5,
  'skip_epoch': 0,
  'target': 'valid_metric'}),
  SaveSnapshot]
15:30:54 deterministic: False
15:30:54 ===== CONFIGEND =====
15:30:54 ===== FOLD0 =====
15:30:54 train positive: [0.00316021 0.04740313 0.27466337 0.01112943 0.02390767 0.1085463
 0.20321517 0.12475955 0.29582303 0.69991756 0.01813685] (7278)
15:30:54 valid positive: [0.0038525  0.04567969 0.2955421  0.01651073 0.0247661  0.12217942
 0.2096863  0.13648872 0.31150248 0.70280682 0.01375894] (1817)
15:30:55 DDP URL :	tcp://127.0.0.1:41351
15:30:55 session id :	68d3593c-7bfc-48c3-82d1-8086cc62177d
15:30:55 __main__ :	/home/hiroshi_yoshihara/kaggle/kaggle-ranzcr-clip-public/train.py
